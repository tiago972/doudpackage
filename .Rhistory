ifelse(bdd.filtered$Score > 60, "Sévère", NA)))))
summary(bdd.filtered$Zarit.cat)
bdd.filtered<-dplyr::select(bdd.filtered, -Score)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, quali = TRUE, complete = FALSE)
?ft_desc_tab
?ft_parse
devtools::load_all("/Users/tiago2/BF/doudpackage")
?ft_parse
setwd("/Users/tiago2/BF/PBR/BDD/Ianay")
library(dplyr)
library(readxl)
library(lubridate)
PBR<-read_excel("THESEPaulbrousse.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(PBR)<-PBR[1,]
PBR<-PBR[-1,]
PBR<-PBR[, -1]
colnames(PBR)[1]<-"Date.inclusion"
colnames(PBR)[4]<-"DDN"
PBR$Centre<-"PBR"
colnames(PBR)
colnames(PBR)[which(colnames(PBR) == "NA")]<-"Polym"
PBR$Age<-round(time_length(as_date(PBR$Date.inclusion) - as_date(PBR$DDN), "years"), digits = 0)
BRC<-read_excel("THESE BROCA.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(BRC)<-BRC[1,]
BRC<-BRC[-1,]
BRC<-BRC[, -1]
colnames(BRC)[1]<-"Date.inclusion"
colnames(BRC)[4]<-"DDN"
BRC$Centre<-"BRC"
colnames(BRC)
colnames(BRC)[which(colnames(BRC) == "NA")]<-"Polym"
BRC$Age<-round(time_length(as_date(BRC$Date.inclusion) - as_date(BRC$DDN), "years"), digits = 0)
BRC<-BRC[-26, ]
setdiff(colnames(BRC), colnames(PBR))
colnames(BRC)[which(colnames(BRC) == "IADL 8")]<-'IADL.8'
bdd<-rbind(BRC, PBR)
bdd$Depression.mix<-as.factor(ifelse(as.numeric(bdd$Depression) > 8, "1", "0"))
Prisca<-read_excel("Prisca.xlsx", col_types = c("guess", "date", "date", rep("guess", 77)))
colnames(Prisca)<-Prisca[1,]
Prisca<-Prisca[-1,]
Prisca$Centre<-"BRC"
colnames(Prisca)[which(colnames(Prisca) == "NA")]<-"Score"
colnames(Prisca)[2]<-"Date.inclusion"
colnames(Prisca)[3]<-"DDN"
Prisca$Age<-round(time_length(as_date(Prisca$Date.inclusion) - as_date(Prisca$DDN), "years"), digits = 0)
Prisca<-Prisca[, -(1:2)]
Prisca$Depression.mix<-as.factor(ifelse(as.numeric(Prisca$`GDS (sur 30)`) > 9, "1", "0"))
Prisca$Créatininémie<-as.numeric(Prisca$Créatininémie)
Prisca$Poids<-as.numeric(Prisca$Poids)
Prisca$Cockroft<-as.numeric(ifelse(Prisca$Sexe=="0", 1.04 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie,
1.23 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie))
Prisca$`Vitamine D`<-ifelse(as.numeric(as.character(Prisca$`Vitamine D`))> 30, "0", "1")
setdiff(colnames(bdd), colnames(Prisca))
setdiff(colnames(Prisca), colnames(bdd))
bdd<-select(bdd, -Date.inclusion, -Nom, -Prenom, -MKDE, -IDE, -Depression, -Anxiete, -Physical, -Psychological, -LOI, -Social.relationships, -Environement, -Spiritual)
Prisca<-select(Prisca, -Créatininémie, -"GDS (sur 30)", -Hamilton, -Pichot)
bdd<-rbind(bdd, Prisca)
bdd<-as.data.frame(bdd)
summary(bdd)
cat("\014")
for (i in 2:ncol(bdd)){
if (is.character(bdd[,i])){
if (colnames(bdd)[i] != "Centre")
bdd[,i]<-as.numeric(bdd[,i])
bdd[,i]<-as.factor(bdd[,i])
if (nlevels(bdd[,i]) == 2 && !colnames(bdd)[i] %in% c("Sexe", "Centre", "Hand grip", "V.marche", "Sexe.aide")){
levels(bdd[,i])<-list("0" = "1", "1" = "0")
}
}
if (nlevels(bdd[,i]) > 5){
bdd[,i]<-as.numeric(as.character(bdd[,i]))
}
}
bdd<-select(bdd, -MMSE.aide)
which(colnames(bdd) == "Ins.card")
which(colnames(bdd) == "VIH")
for (i in 18:36){
bdd[,i]<-as.factor(ifelse(is.na(bdd[,i]), "0", bdd[,i]))
}
bdd$Charlson<-as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +  as.numeric(ifelse(bdd$Ins.card == "1", 1, 0)) +
as.numeric(ifelse(bdd$AOMI == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +
as.numeric(ifelse(bdd$AVC == "1", 1, 0)) + as.numeric(ifelse(bdd$Trble.cog == "1", 1, 0)) +
as.numeric(ifelse(bdd$Ins.respi == "1", 1, 0)) + as.numeric(ifelse(bdd$Connectivite == "1", 1, 0)) +
as.numeric(ifelse(bdd$RGO == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.hepatique.legere == "1", 1, 0)) +
as.numeric(ifelse(bdd$Diabete.non.complique == "1", 1, 0)) + as.numeric(ifelse(bdd$Hemiplegie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Ins.renale == "1", 2, 0)) + as.numeric(ifelse(bdd$Diabete.complique == "1", 2, 0)) +
as.numeric(ifelse(bdd$`K.M-` == "1", 2, 0)) + as.numeric(ifelse(bdd$Leucemie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Lymphome == "1", 2, 0)) + as.numeric(ifelse(bdd$`Ins.hepatique.moderee/severe` == "1", 3, 0)) +
as.numeric(ifelse(bdd$`K.M+` == "1", 6, 0)) + as.numeric(ifelse(bdd$VIH == "1", 6, 0))
bdd.filtered<-dplyr::filter(bdd, !is.na(Score))
summary(bdd.filtered)
bdd.filtered$carence.martiale<-as.factor(ifelse(bdd.filtered$Ferritine < 100 | (bdd.filtered$Ferritine < 300 & bdd.filtered$CST < 20), "1", "0"))
bdd.filtered<-select(bdd.filtered, -CST, -Ferritine)
summary(bdd.filtered)
bdd.filtered$Zarit.cat<-as.factor(ifelse(bdd.filtered$Score <= 20, "Nulle",
ifelse(bdd.filtered$Score > 21 & bdd.filtered$Score <= 40, "Légère",
ifelse(bdd.filtered$Score > 40 & bdd.filtered$Score <= 60, "Modérée",
ifelse(bdd.filtered$Score > 60, "Sévère", NA)))))
summary(bdd.filtered$Zarit.cat)
bdd.filtered<-dplyr::select(bdd.filtered, -Score, -Deficit.sensoriel, -Duree.evol.maladie)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, quali = TRUE, complete = FALSE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, quali = TRUE, complete = FALSE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, quali = TRUE, complete = FALSE)
summary(bdd.NvsL)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, quali = TRUE, complete = FALSE)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
exit
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
summary(bdd.filtered$VIH)
setwd("/Users/tiago2/BF/PBR/BDD/Ianay")
library(dplyr)
library(readxl)
library(lubridate)
PBR<-read_excel("THESEPaulbrousse.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(PBR)<-PBR[1,]
PBR<-PBR[-1,]
PBR<-PBR[, -1]
colnames(PBR)[1]<-"Date.inclusion"
colnames(PBR)[4]<-"DDN"
PBR$Centre<-"PBR"
colnames(PBR)
colnames(PBR)[which(colnames(PBR) == "NA")]<-"Polym"
PBR$Age<-round(time_length(as_date(PBR$Date.inclusion) - as_date(PBR$DDN), "years"), digits = 0)
BRC<-read_excel("THESE BROCA.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(BRC)<-BRC[1,]
BRC<-BRC[-1,]
BRC<-BRC[, -1]
colnames(BRC)[1]<-"Date.inclusion"
colnames(BRC)[4]<-"DDN"
BRC$Centre<-"BRC"
colnames(BRC)
colnames(BRC)[which(colnames(BRC) == "NA")]<-"Polym"
BRC$Age<-round(time_length(as_date(BRC$Date.inclusion) - as_date(BRC$DDN), "years"), digits = 0)
BRC<-BRC[-26, ]
setdiff(colnames(BRC), colnames(PBR))
colnames(BRC)[which(colnames(BRC) == "IADL 8")]<-'IADL.8'
bdd<-rbind(BRC, PBR)
bdd$Depression.mix<-as.factor(ifelse(as.numeric(bdd$Depression) > 8, "1", "0"))
Prisca<-read_excel("Prisca.xlsx", col_types = c("guess", "date", "date", rep("guess", 77)))
colnames(Prisca)<-Prisca[1,]
Prisca<-Prisca[-1,]
Prisca$Centre<-"BRC"
colnames(Prisca)[which(colnames(Prisca) == "NA")]<-"Score"
colnames(Prisca)[2]<-"Date.inclusion"
colnames(Prisca)[3]<-"DDN"
Prisca$Age<-round(time_length(as_date(Prisca$Date.inclusion) - as_date(Prisca$DDN), "years"), digits = 0)
Prisca<-Prisca[, -(1:2)]
Prisca$Depression.mix<-as.factor(ifelse(as.numeric(Prisca$`GDS (sur 30)`) > 9, "1", "0"))
Prisca$Créatininémie<-as.numeric(Prisca$Créatininémie)
Prisca$Poids<-as.numeric(Prisca$Poids)
Prisca$Cockroft<-as.numeric(ifelse(Prisca$Sexe=="0", 1.04 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie,
1.23 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie))
Prisca$`Vitamine D`<-ifelse(as.numeric(as.character(Prisca$`Vitamine D`))> 30, "0", "1")
setdiff(colnames(bdd), colnames(Prisca))
setdiff(colnames(Prisca), colnames(bdd))
bdd<-select(bdd, -Date.inclusion, -Nom, -Prenom, -MKDE, -IDE, -Depression, -Anxiete, -Physical, -Psychological, -LOI, -Social.relationships, -Environement, -Spiritual)
Prisca<-select(Prisca, -Créatininémie, -"GDS (sur 30)", -Hamilton, -Pichot)
bdd<-rbind(bdd, Prisca)
bdd<-as.data.frame(bdd)
summary(bdd)
cat("\014")
for (i in 2:ncol(bdd)){
if (is.character(bdd[,i])){
if (colnames(bdd)[i] != "Centre")
bdd[,i]<-as.numeric(bdd[,i])
bdd[,i]<-as.factor(bdd[,i])
if (nlevels(bdd[,i]) == 2 && !colnames(bdd)[i] %in% c("Sexe", "Centre", "Hand grip", "V.marche", "Sexe.aide")){
levels(bdd[,i])<-list("0" = "1", "1" = "0")
}
}
if (nlevels(bdd[,i]) > 5){
bdd[,i]<-as.numeric(as.character(bdd[,i]))
}
}
bdd<-select(bdd, -MMSE.aide)
which(colnames(bdd) == "Ins.card")
which(colnames(bdd) == "VIH")
for (i in 18:36){
bdd[,i]<-as.factor(ifelse(is.na(bdd[,i]), "0", bdd[,i]))
}
bdd$Charlson<-as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +  as.numeric(ifelse(bdd$Ins.card == "1", 1, 0)) +
as.numeric(ifelse(bdd$AOMI == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +
as.numeric(ifelse(bdd$AVC == "1", 1, 0)) + as.numeric(ifelse(bdd$Trble.cog == "1", 1, 0)) +
as.numeric(ifelse(bdd$Ins.respi == "1", 1, 0)) + as.numeric(ifelse(bdd$Connectivite == "1", 1, 0)) +
as.numeric(ifelse(bdd$RGO == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.hepatique.legere == "1", 1, 0)) +
as.numeric(ifelse(bdd$Diabete.non.complique == "1", 1, 0)) + as.numeric(ifelse(bdd$Hemiplegie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Ins.renale == "1", 2, 0)) + as.numeric(ifelse(bdd$Diabete.complique == "1", 2, 0)) +
as.numeric(ifelse(bdd$`K.M-` == "1", 2, 0)) + as.numeric(ifelse(bdd$Leucemie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Lymphome == "1", 2, 0)) + as.numeric(ifelse(bdd$`Ins.hepatique.moderee/severe` == "1", 3, 0)) +
as.numeric(ifelse(bdd$`K.M+` == "1", 6, 0)) + as.numeric(ifelse(bdd$VIH == "1", 6, 0))
bdd.filtered<-dplyr::filter(bdd, !is.na(Score))
summary(bdd.filtered)
bdd.filtered$carence.martiale<-as.factor(ifelse(bdd.filtered$Ferritine < 100 | (bdd.filtered$Ferritine < 300 & bdd.filtered$CST < 20), "1", "0"))
bdd.filtered<-select(bdd.filtered, -CST, -Ferritine)
summary(bdd.filtered)
bdd.filtered$Zarit.cat<-as.factor(ifelse(bdd.filtered$Score <= 20, "Nulle",
ifelse(bdd.filtered$Score > 21 & bdd.filtered$Score <= 40, "Légère",
ifelse(bdd.filtered$Score > 40 & bdd.filtered$Score <= 60, "Modérée",
ifelse(bdd.filtered$Score > 60, "Sévère", NA)))))
summary(bdd.filtered$Zarit.cat)
bdd.filtered<-dplyr::select(bdd.filtered, -Score, -Deficit.sensoriel, -Duree.evol.maladie)
summary(filtered)
summary(bdd.filtered)
setwd("/Users/tiago2/BF/PBR/BDD/Ianay")
library(dplyr)
library(readxl)
library(lubridate)
PBR<-read_excel("THESEPaulbrousse.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(PBR)<-PBR[1,]
PBR<-PBR[-1,]
PBR<-PBR[, -1]
colnames(PBR)[1]<-"Date.inclusion"
colnames(PBR)[4]<-"DDN"
PBR$Centre<-"PBR"
colnames(PBR)
colnames(PBR)[which(colnames(PBR) == "NA")]<-"Polym"
PBR$Age<-round(time_length(as_date(PBR$Date.inclusion) - as_date(PBR$DDN), "years"), digits = 0)
BRC<-read_excel("THESE BROCA.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(BRC)<-BRC[1,]
BRC<-BRC[-1,]
BRC<-BRC[, -1]
colnames(BRC)[1]<-"Date.inclusion"
colnames(BRC)[4]<-"DDN"
BRC$Centre<-"BRC"
colnames(BRC)
colnames(BRC)[which(colnames(BRC) == "NA")]<-"Polym"
BRC$Age<-round(time_length(as_date(BRC$Date.inclusion) - as_date(BRC$DDN), "years"), digits = 0)
BRC<-BRC[-26, ]
setdiff(colnames(BRC), colnames(PBR))
colnames(BRC)[which(colnames(BRC) == "IADL 8")]<-'IADL.8'
bdd<-rbind(BRC, PBR)
bdd$Depression.mix<-as.factor(ifelse(as.numeric(bdd$Depression) > 8, "1", "0"))
Prisca<-read_excel("Prisca.xlsx", col_types = c("guess", "date", "date", rep("guess", 77)))
colnames(Prisca)<-Prisca[1,]
Prisca<-Prisca[-1,]
Prisca$Centre<-"BRC"
colnames(Prisca)[which(colnames(Prisca) == "NA")]<-"Score"
colnames(Prisca)[2]<-"Date.inclusion"
colnames(Prisca)[3]<-"DDN"
Prisca$Age<-round(time_length(as_date(Prisca$Date.inclusion) - as_date(Prisca$DDN), "years"), digits = 0)
Prisca<-Prisca[, -(1:2)]
Prisca$Depression.mix<-as.factor(ifelse(as.numeric(Prisca$`GDS (sur 30)`) > 9, "1", "0"))
Prisca$Créatininémie<-as.numeric(Prisca$Créatininémie)
Prisca$Poids<-as.numeric(Prisca$Poids)
Prisca$Cockroft<-as.numeric(ifelse(Prisca$Sexe=="0", 1.04 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie,
1.23 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie))
Prisca$`Vitamine D`<-ifelse(as.numeric(as.character(Prisca$`Vitamine D`))> 30, "0", "1")
setdiff(colnames(bdd), colnames(Prisca))
setdiff(colnames(Prisca), colnames(bdd))
bdd<-select(bdd, -Date.inclusion, -Nom, -Prenom, -MKDE, -IDE, -Depression, -Anxiete, -Physical, -Psychological, -LOI, -Social.relationships, -Environement, -Spiritual)
Prisca<-select(Prisca, -Créatininémie, -"GDS (sur 30)", -Hamilton, -Pichot)
bdd<-rbind(bdd, Prisca)
bdd<-as.data.frame(bdd)
summary(bdd)
bdd$VIH
as.numeric(bdd$VIH)
as.factor(as.numeric(bdd$VIH))
setwd("/Users/tiago2/BF/PBR/BDD/Ianay")
library(dplyr)
library(readxl)
library(lubridate)
PBR<-read_excel("THESEPaulbrousse.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(PBR)<-PBR[1,]
PBR<-PBR[-1,]
PBR<-PBR[, -1]
colnames(PBR)[1]<-"Date.inclusion"
colnames(PBR)[4]<-"DDN"
PBR$Centre<-"PBR"
colnames(PBR)
colnames(PBR)[which(colnames(PBR) == "NA")]<-"Polym"
PBR$Age<-round(time_length(as_date(PBR$Date.inclusion) - as_date(PBR$DDN), "years"), digits = 0)
BRC<-read_excel("THESE BROCA.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(BRC)<-BRC[1,]
BRC<-BRC[-1,]
BRC<-BRC[, -1]
colnames(BRC)[1]<-"Date.inclusion"
colnames(BRC)[4]<-"DDN"
BRC$Centre<-"BRC"
colnames(BRC)
colnames(BRC)[which(colnames(BRC) == "NA")]<-"Polym"
BRC$Age<-round(time_length(as_date(BRC$Date.inclusion) - as_date(BRC$DDN), "years"), digits = 0)
BRC<-BRC[-26, ]
setdiff(colnames(BRC), colnames(PBR))
colnames(BRC)[which(colnames(BRC) == "IADL 8")]<-'IADL.8'
bdd<-rbind(BRC, PBR)
bdd$Depression.mix<-as.factor(ifelse(as.numeric(bdd$Depression) > 8, "1", "0"))
Prisca<-read_excel("Prisca.xlsx", col_types = c("guess", "date", "date", rep("guess", 77)))
colnames(Prisca)<-Prisca[1,]
Prisca<-Prisca[-1,]
Prisca$Centre<-"BRC"
colnames(Prisca)[which(colnames(Prisca) == "NA")]<-"Score"
colnames(Prisca)[2]<-"Date.inclusion"
colnames(Prisca)[3]<-"DDN"
Prisca$Age<-round(time_length(as_date(Prisca$Date.inclusion) - as_date(Prisca$DDN), "years"), digits = 0)
Prisca<-Prisca[, -(1:2)]
Prisca$Depression.mix<-as.factor(ifelse(as.numeric(Prisca$`GDS (sur 30)`) > 9, "1", "0"))
Prisca$Créatininémie<-as.numeric(Prisca$Créatininémie)
Prisca$Poids<-as.numeric(Prisca$Poids)
Prisca$Cockroft<-as.numeric(ifelse(Prisca$Sexe=="0", 1.04 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie,
1.23 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie))
Prisca$`Vitamine D`<-ifelse(as.numeric(as.character(Prisca$`Vitamine D`))> 30, "0", "1")
setdiff(colnames(bdd), colnames(Prisca))
setdiff(colnames(Prisca), colnames(bdd))
bdd<-select(bdd, -Date.inclusion, -Nom, -Prenom, -MKDE, -IDE, -Depression, -Anxiete, -Physical, -Psychological, -LOI, -Social.relationships, -Environement, -Spiritual)
Prisca<-select(Prisca, -Créatininémie, -"GDS (sur 30)", -Hamilton, -Pichot)
bdd<-rbind(bdd, Prisca)
bdd<-as.data.frame(bdd)
summary(bdd)
cat("\014")
for (i in 2:ncol(bdd)){
if (is.character(bdd[,i])){
if (colnames(bdd)[i] != "Centre")
bdd[,i]<-as.numeric(bdd[,i])
bdd[,i]<-as.factor(bdd[,i])
if (nlevels(bdd[,i]) == 2 && !colnames(bdd)[i] %in% c("Sexe", "Centre", "Hand grip", "V.marche", "Sexe.aide")){
levels(bdd[,i])<-list("0" = "1", "1" = "0")
}
}
if (nlevels(bdd[,i]) > 5){
bdd[,i]<-as.numeric(as.character(bdd[,i]))
}
}
bdd<-select(bdd, -MMSE.aide)
which(colnames(bdd) == "Ins.card")
which(colnames(bdd) == "VIH")
bdd$VIH
for (i in 18:36){
bdd[,i]<-as.factor(ifelse(is.na(bdd[,i]), "0", as.character(bdd[,i])))
}
bdd$VIH
bdd$Charlson<-as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +  as.numeric(ifelse(bdd$Ins.card == "1", 1, 0)) +
as.numeric(ifelse(bdd$AOMI == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +
as.numeric(ifelse(bdd$AVC == "1", 1, 0)) + as.numeric(ifelse(bdd$Trble.cog == "1", 1, 0)) +
as.numeric(ifelse(bdd$Ins.respi == "1", 1, 0)) + as.numeric(ifelse(bdd$Connectivite == "1", 1, 0)) +
as.numeric(ifelse(bdd$RGO == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.hepatique.legere == "1", 1, 0)) +
as.numeric(ifelse(bdd$Diabete.non.complique == "1", 1, 0)) + as.numeric(ifelse(bdd$Hemiplegie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Ins.renale == "1", 2, 0)) + as.numeric(ifelse(bdd$Diabete.complique == "1", 2, 0)) +
as.numeric(ifelse(bdd$`K.M-` == "1", 2, 0)) + as.numeric(ifelse(bdd$Leucemie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Lymphome == "1", 2, 0)) + as.numeric(ifelse(bdd$`Ins.hepatique.moderee/severe` == "1", 3, 0)) +
as.numeric(ifelse(bdd$`K.M+` == "1", 6, 0)) + as.numeric(ifelse(bdd$VIH == "1", 6, 0))
bdd.filtered<-dplyr::filter(bdd, !is.na(Score))
summary(bdd.filtered)
bdd.filtered$carence.martiale<-as.factor(ifelse(bdd.filtered$Ferritine < 100 | (bdd.filtered$Ferritine < 300 & bdd.filtered$CST < 20), "1", "0"))
bdd.filtered<-select(bdd.filtered, -CST, -Ferritine)
summary(bdd.filtered)
bdd.filtered$Zarit.cat<-as.factor(ifelse(bdd.filtered$Score <= 20, "Nulle",
ifelse(bdd.filtered$Score > 21 & bdd.filtered$Score <= 40, "Légère",
ifelse(bdd.filtered$Score > 40 & bdd.filtered$Score <= 60, "Modérée",
ifelse(bdd.filtered$Score > 60, "Sévère", NA)))))
summary(bdd.filtered$Zarit.cat)
bdd.filtered<-dplyr::select(bdd.filtered, -Score, -Deficit.sensoriel, -Duree.evol.maladie)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
setwd("/Users/tiago2/BF/PBR/BDD/Ianay")
library(dplyr)
library(readxl)
library(lubridate)
PBR<-read_excel("THESEPaulbrousse.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(PBR)<-PBR[1,]
PBR<-PBR[-1,]
PBR<-PBR[, -1]
colnames(PBR)[1]<-"Date.inclusion"
colnames(PBR)[4]<-"DDN"
PBR$Centre<-"PBR"
colnames(PBR)
colnames(PBR)[which(colnames(PBR) == "NA")]<-"Polym"
PBR$Age<-round(time_length(as_date(PBR$Date.inclusion) - as_date(PBR$DDN), "years"), digits = 0)
BRC<-read_excel("THESE BROCA.xlsx", col_types = c("guess", "date",rep("guess", 2), "date", rep("guess", 84)))
colnames(BRC)<-BRC[1,]
BRC<-BRC[-1,]
BRC<-BRC[, -1]
colnames(BRC)[1]<-"Date.inclusion"
colnames(BRC)[4]<-"DDN"
BRC$Centre<-"BRC"
colnames(BRC)
colnames(BRC)[which(colnames(BRC) == "NA")]<-"Polym"
BRC$Age<-round(time_length(as_date(BRC$Date.inclusion) - as_date(BRC$DDN), "years"), digits = 0)
BRC<-BRC[-26, ]
setdiff(colnames(BRC), colnames(PBR))
colnames(BRC)[which(colnames(BRC) == "IADL 8")]<-'IADL.8'
bdd<-rbind(BRC, PBR)
bdd$Depression.mix<-as.factor(ifelse(as.numeric(bdd$Depression) > 8, "1", "0"))
Prisca<-read_excel("Prisca.xlsx", col_types = c("guess", "date", "date", rep("guess", 77)))
colnames(Prisca)<-Prisca[1,]
Prisca<-Prisca[-1,]
Prisca$Centre<-"BRC"
colnames(Prisca)[which(colnames(Prisca) == "NA")]<-"Score"
colnames(Prisca)[2]<-"Date.inclusion"
colnames(Prisca)[3]<-"DDN"
Prisca$Age<-round(time_length(as_date(Prisca$Date.inclusion) - as_date(Prisca$DDN), "years"), digits = 0)
Prisca<-Prisca[, -(1:2)]
Prisca$Depression.mix<-as.factor(ifelse(as.numeric(Prisca$`GDS (sur 30)`) > 9, "1", "0"))
Prisca$Créatininémie<-as.numeric(Prisca$Créatininémie)
Prisca$Poids<-as.numeric(Prisca$Poids)
Prisca$Cockroft<-as.numeric(ifelse(Prisca$Sexe=="0", 1.04 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie,
1.23 * Prisca$Poids * (140 - Prisca$Age)/Prisca$Créatininémie))
Prisca$`Vitamine D`<-ifelse(as.numeric(as.character(Prisca$`Vitamine D`))> 30, "0", "1")
setdiff(colnames(bdd), colnames(Prisca))
setdiff(colnames(Prisca), colnames(bdd))
bdd<-select(bdd, -Date.inclusion, -Nom, -Prenom, -MKDE, -IDE, -Depression, -Anxiete, -Physical, -Psychological, -LOI, -Social.relationships, -Environement, -Spiritual)
Prisca<-select(Prisca, -Créatininémie, -"GDS (sur 30)", -Hamilton, -Pichot)
bdd<-rbind(bdd, Prisca)
bdd<-as.data.frame(bdd)
summary(bdd)
cat("\014")
for (i in 2:ncol(bdd)){
if (is.character(bdd[,i])){
if (colnames(bdd)[i] != "Centre")
bdd[,i]<-as.numeric(bdd[,i])
bdd[,i]<-as.factor(bdd[,i])
if (nlevels(bdd[,i]) == 2 && !colnames(bdd)[i] %in% c("Sexe", "Centre", "Hand grip", "V.marche", "Sexe.aide")){
levels(bdd[,i])<-list("0" = "1", "1" = "0")
}
}
if (nlevels(bdd[,i]) > 5){
bdd[,i]<-as.numeric(as.character(bdd[,i]))
}
}
bdd<-select(bdd, -MMSE.aide)
which(colnames(bdd) == "Ins.card")
which(colnames(bdd) == "VIH")
for (i in 18:36){
bdd[,i]<-as.factor(ifelse(is.na(bdd[,i]), "0", as.character(bdd[,i])))
}
bdd$Charlson<-as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +  as.numeric(ifelse(bdd$Ins.card == "1", 1, 0)) +
as.numeric(ifelse(bdd$AOMI == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.coronaire == "1", 1, 0)) +
as.numeric(ifelse(bdd$AVC == "1", 1, 0)) + as.numeric(ifelse(bdd$Trble.cog == "1", 1, 0)) +
as.numeric(ifelse(bdd$Ins.respi == "1", 1, 0)) + as.numeric(ifelse(bdd$Connectivite == "1", 1, 0)) +
as.numeric(ifelse(bdd$RGO == "1", 1, 0)) + as.numeric(ifelse(bdd$Ins.hepatique.legere == "1", 1, 0)) +
as.numeric(ifelse(bdd$Diabete.non.complique == "1", 1, 0)) + as.numeric(ifelse(bdd$Hemiplegie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Ins.renale == "1", 2, 0)) + as.numeric(ifelse(bdd$Diabete.complique == "1", 2, 0)) +
as.numeric(ifelse(bdd$`K.M-` == "1", 2, 0)) + as.numeric(ifelse(bdd$Leucemie == "1", 2, 0)) +
as.numeric(ifelse(bdd$Lymphome == "1", 2, 0)) + as.numeric(ifelse(bdd$`Ins.hepatique.moderee/severe` == "1", 3, 0)) +
as.numeric(ifelse(bdd$`K.M+` == "1", 6, 0)) + as.numeric(ifelse(bdd$VIH == "1", 6, 0))
bdd.filtered<-dplyr::filter(bdd, !is.na(Score))
summary(bdd.filtered)
bdd.filtered$carence.martiale<-as.factor(ifelse(bdd.filtered$Ferritine < 100 | (bdd.filtered$Ferritine < 300 & bdd.filtered$CST < 20), "1", "0"))
bdd.filtered<-select(bdd.filtered, -CST, -Ferritine)
summary(bdd.filtered)
bdd.filtered$Zarit.cat<-as.factor(ifelse(bdd.filtered$Score <= 20, "Nulle",
ifelse(bdd.filtered$Score > 21 & bdd.filtered$Score <= 40, "Légère",
ifelse(bdd.filtered$Score > 40 & bdd.filtered$Score <= 60, "Modérée",
ifelse(bdd.filtered$Score > 60, "Sévère", NA)))))
summary(bdd.filtered$Zarit.cat)
bdd.filtered<-dplyr::select(bdd.filtered, -Score, -Deficit.sensoriel, -Duree.evol.maladie, -DDN, -Date.inclusion)
bdd.filtered<-dplyr::select(bdd.filtered, -Score, -Deficit.sensoriel, -Duree.evol.maladie, -DDN)
summary(bdd.filtered)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = TRUE, na.print = TRUE)
summary(bdd.filtered$Rockwood)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = FALSE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = FALSE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = FALSE)
devtools::load_all("/Users/tiago2/BF/doudpackage")
bdd.NvsL<-dplyr::filter(bdd.filtered, Zarit.cat == "Nulle" |  Zarit.cat== "Légère")
bdd.NvsL$Zarit.cat<-droplevels(bdd.NvsL$Zarit.cat)
univ.NvsL<-ft_desc_tab(bdd.NvsL, group = 'Zarit.cat', nonnormal = FALSE)
devtools::check()
